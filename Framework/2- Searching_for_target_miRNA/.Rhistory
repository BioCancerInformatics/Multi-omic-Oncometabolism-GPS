Gene = gene,
p.value = p_value,
Type = Type,
cancer = cancer
)
# Adiciona o data frame tempor√°rio aos resultados principais
results <- rbind(results, temp_df)
}
View(results)
View(results)
# Realiza a jun√ß√£o (merge) entre original_data e results usando a coluna Gene como chave de jun√ß√£o
merged_data <- merge(original_data, results, by = "Gene", all.x = TRUE)
# Realiza a jun√ß√£o (merge) entre original_data e results usando a coluna Gene como chave de jun√ß√£o
merged_data <- merge(genes, results, by = "Gene", all.x = TRUE)
# Realiza a jun√ß√£o (merge) entre original_data e results usando a coluna Gene como chave de jun√ß√£o
merged_data <- merge(genes, results, by = "genes", all.x = TRUE)
# Realiza a jun√ß√£o (merge) entre original_data e results usando a coluna Gene como chave de jun√ß√£o
merged_data <- merge(genes, results, by = "genes", all.x = TRUE)
# Realiza a jun√ß√£o (merge) entre original_data e results usando a coluna Gene como chave de jun√ß√£o
merged_data <- merge(genes, results, by = "cancer_types", all.x = TRUE)
View(genes)
# Realiza a jun√ß√£o (merge) entre original_data e results usando a coluna Gene como chave de jun√ß√£o
merged_data <- merge(genes, results,by.x = "genes", by.y = "Gene", all.x = TRUE)
View(merged_data)
View(merged_data)
# Seleciona apenas as colunas desejadas
final_data <- merged_data[, c("genes", "p.value", "Type", "cancer_types")]
View(final_data)
# Dataframe
genes <- import("F:/Higor/Bioenergetic_gene_analysis_004/1- Bioenergetic_Radar_Analysis/Overall_Results_PanCan/Overall_correlation_results.tsv")
genes <- head(genes, 10)
results <- data.frame()  # Cria um data frame vazio para armazenar os resultados
for (gene in genes$genes) {
cox_result <- vis_unicox_tree(
Gene = gene,
measure = "OS",
data_type = "mRNA",
threshold = 0.5
)
# Extrai os valores de p.value, Type e cancer
p_value <- cox_result[["data"]][["p.value"]]
Type <- cox_result[["data"]][["Type"]]
cancer <- cox_result[["data"]][["cancer"]]
# Cria um data frame tempor√°rio com os resultados atuais
temp_df <- data.frame(
Gene = gene,
p.value = p_value,
Type = Type,
cancer = cancer
)
# Adiciona o data frame tempor√°rio aos resultados principais
results <- rbind(results, temp_df)
}
# Supondo que genes$cancer_types contenha os tipos de c√¢ncer de interesse
cancer_types <- unique(genes$cancer_types)  # Obt√©m os tipos de c√¢ncer √∫nicos do data frame original
# Filtra os resultados apenas para os tipos de c√¢ncer presentes em cancer_types
filtered_results <- subset(results, cancer %in% cancer_types)
View(filtered_results)
results <- data.frame()  # Cria um data frame vazio para armazenar os resultados
for (gene in genes$genes) {
cox_result <- vis_unicox_tree(
Gene = gene,
measure = "OS",
data_type = "mRNA",
threshold = 0.5
)
# Extrai os valores de p.value, Type e cancer
p_value <- cox_result[["data"]][["p.value"]]
Type <- cox_result[["data"]][["Type"]]
cancer <- cox_result[["data"]][["cancer"]]
# Cria um data frame tempor√°rio com os resultados atuais
temp_df <- data.frame(
Gene = gene,
p.value = p_value,
Type = Type,
cancer = cancer
)
# Adiciona o data frame tempor√°rio aos resultados principais
results <- rbind(results, temp_df)
}
# Supondo que genes$cancer_types contenha os tipos de c√¢ncer de interesse
cancer_types <- unique(genes$cancer_types)  # Obt√©m os tipos de c√¢ncer √∫nicos do data frame original
# Inicializa um data frame vazio para armazenar os resultados finais
final_results <- data.frame(Gene = character(), p.value = numeric(), Type = character(), cancer = character(), stringsAsFactors = FALSE)
for (cancer_type in cancer_types) {
# Filtra os resultados apenas para o tipo de c√¢ncer atual
filtered_results <- subset(results, cancer == cancer_type)
# Verifica se h√° resultados para esse tipo de c√¢ncer
if (nrow(filtered_results) > 0) {
# Adiciona os resultados filtrados ao data frame final
final_results <- rbind(final_results, filtered_results[1, ])  # Assume que s√≥ h√° uma linha por tipo de c√¢ncer
}
}
View(final_results)
View(filtered_results)
View(filtered_results)
# Dataframe
genes <- import("F:/Higor/Bioenergetic_gene_analysis_004/1- Bioenergetic_Radar_Analysis/Overall_Results_PanCan/Overall_correlation_results.tsv")
genes <- head(genes, 10)
results <- data.frame()  # Cria um data frame vazio para armazenar os resultados
for (gene in genes$genes) {
cox_result <- vis_unicox_tree(
Gene = gene,
measure = "OS",
data_type = "mRNA",
threshold = 0.5
)
# Extrai os valores de p.value, Type e cancer
p_value <- cox_result[["data"]][["p.value"]]
Type <- cox_result[["data"]][["Type"]]
cancer <- cox_result[["data"]][["cancer"]]
# Cria um data frame tempor√°rio com os resultados atuais
temp_df <- data.frame(
Gene = gene,
p.value = p_value,
Type = Type,
cancer = cancer
)
# Adiciona o data frame tempor√°rio aos resultados principais
results <- rbind(results, temp_df)
}
# Supondo que genes$cancer_types contenha os tipos de c√¢ncer de interesse
cancer_types <- unique(genes$cancer_types)  # Obt√©m os tipos de c√¢ncer √∫nicos do data frame original
# Inicializa um data frame vazio para armazenar os resultados finais
final_results <- data.frame(Gene = character(), p.value = numeric(), Type = character(), cancer = character(), stringsAsFactors = FALSE)
# Itera sobre cada linha de genes e cancer_types
for (i in 1:nrow(genes)) {
gene <- genes$genes[i]
cancer_type <- genes$cancer_types[i]
# Filtra os resultados apenas para o gene e tipo de c√¢ncer atuais
filtered_results <- subset(results, Gene == gene & cancer == cancer_type)
# Verifica se h√° resultados para esse gene e tipo de c√¢ncer
if (nrow(filtered_results) > 0) {
# Adiciona os resultados filtrados ao data frame final
final_results <- rbind(final_results, filtered_results)
}
}
View(filtered_results)
View(final_results)
View(final_results)
View(genes)
View(final_results)
View(final_results)
# Renomeia as colunas em `final_results` para evitar conflitos ao mesclar
colnames(final_results) <- c("Gene", "p.value", "Type", "cancer")
# Mescla os dados de `final_results` de volta para `genes`
merged_genes <- merge(genes, final_results[, c("Gene", "p.value", "Type", "cancer")],
by = c("genes", "cancer_types"),
all.x = TRUE)
# Renomeia as colunas em final_results para evitar conflitos ao mesclar
colnames(final_results) <- c("Gene", "p.value", "Type", "cancer")
# Mescla os data frames genes e final_results pelo Gene e cancer
merged_genes <- merge(genes, final_results[, c("Gene", "p.value", "Type")], by = c("genes", "cancer_types"), all.x = TRUE)
# Mescla os data frames genes e final_results pelo Gene e cancer_types
merged_genes <- merge(genes, final_results[, c("Gene", "p.value", "Type", "cancer")],
by.x = c("genes", "cancer_types"),
by.y = c("Gene", "cancer"),
all.x = TRUE)
View(merged_genes)
# Inicializa um data frame vazio para armazenar os resultados finais
final_results <- data.frame(Gene = character(), p.value_Cox_OS = numeric(), Type_Cox_OS = character(), cancer = character(), stringsAsFactors = FALSE)
View(filtered_results)
View(final_results)
# Itera sobre cada linha de genes e cancer_types
for (i in 1:nrow(genes)) {
gene <- genes$genes[i]
cancer_type <- genes$cancer_types[i]
# Filtra os resultados apenas para o gene e tipo de c√¢ncer atuais
filtered_results <- subset(results, Gene == gene & cancer == cancer_type)
# Verifica se h√° resultados para esse gene e tipo de c√¢ncer
if (nrow(filtered_results) > 0) {
# Adiciona os resultados filtrados ao data frame final
final_results <- rbind(final_results, filtered_results)
}
}
# Renomeia as colunas em final_results para evitar conflitos ao mesclar
colnames(final_results) <- c("Gene", "p.value_Cox_OS", "Type_Cox_OS", "cancer")
# Mescla os data frames genes e final_results pelo Gene e cancer_types
merged_genes <- merge(genes, final_results[, c("Gene", "p.value_Cox_OS", "Type_Cox_OS", "cancer")],
by.x = c("genes", "cancer_types"),
by.y = c("Gene", "cancer"),
all.x = TRUE)
View(merged_genes)
# Dataframe
genes <- import("F:/Higor/Bioenergetic_gene_analysis_004/1- Bioenergetic_Radar_Analysis/Overall_Results_PanCan/Overall_correlation_results.tsv")
genes <- head(genes, 10)
# Fun√ß√£o para realizar an√°lise de Cox para uma m√©trica espec√≠fica
perform_cox_analysis <- function(genes, measure) {
results <- data.frame()  # Cria um data frame vazio para armazenar os resultados
for (gene in genes$genes) {
cox_result <- vis_unicox_tree(
Gene = gene,
measure = measure,
data_type = "mRNA",
threshold = 0.5
)
# Extrai os valores de p.value, Type e cancer
p_value <- cox_result[["data"]][["p.value"]]
Type <- cox_result[["data"]][["Type"]]
cancer <- cox_result[["data"]][["cancer"]]
# Cria um data frame tempor√°rio com os resultados atuais
temp_df <- data.frame(
Gene = gene,
p.value = p_value,
Type = Type,
cancer = cancer
)
# Adiciona o data frame tempor√°rio aos resultados principais
results <- rbind(results, temp_df)
}
# Inicializa um data frame vazio para armazenar os resultados finais
final_results <- data.frame(Gene = character(), p.value = numeric(), Type = character(), cancer = character(), stringsAsFactors = FALSE)
# Itera sobre cada linha de genes e cancer_types
for (i in 1:nrow(genes)) {
gene <- genes$genes[i]
cancer_type <- genes$cancer_types[i]
# Filtra os resultados apenas para o gene e tipo de c√¢ncer atuais
filtered_results <- subset(results, Gene == gene & cancer == cancer_type)
# Verifica se h√° resultados para esse gene e tipo de c√¢ncer
if (nrow(filtered_results) > 0) {
# Adiciona os resultados filtrados ao data frame final
final_results <- rbind(final_results, filtered_results)
}
}
# Renomeia as colunas em final_results para evitar conflitos ao mesclar
colnames(final_results) <- c("Gene", paste0("p.value_Cox_", measure), paste0("Type_Cox_", measure), "cancer")
# Mescla os data frames genes e final_results pelo Gene e cancer_types
merged_genes <- merge(genes, final_results[, c("Gene", paste0("p.value_Cox_", measure), paste0("Type_Cox_", measure), "cancer")],
by.x = c("genes", "cancer_types"),
by.y = c("Gene", "cancer"),
all.x = TRUE)
return(merged_genes)
}
# Aplicar a fun√ß√£o para cada m√©trica e armazenar os resultados no data frame genes
measures <- c("OS", "DSS", "DFI", "PFI")
genes_merged <- genes
for (measure in measures) {
genes_merged <- perform_cox_analysis(genes_merged, measure)
}
View(genes_merged)
View(genes_merged)
# Carregar as bibliotecas necess√°rias
install.packages("cluster")
install.packages("dendextend")
library(cluster)
library(dendextend)
# conjunto de dados de exemplo
set.seed(123)
data <- matrix(rnorm(100), nrow = 20)
# Calcular a matriz de dist√¢ncias
dist_matrix <- dist(data)
# Aplicar o m√©todo de liga√ß√£o m√©dia entre grupo (UPGMA)
hc <- hclust(dist_matrix, method = "average")
View(hc)
# Converter para um dendrograma
dend <- as.dendrogram(hc)
# Personalizar o dendrograma
dend <- dend %>%
color_branches(k = 4) %>%  # Definir o n√∫mero de clusters
color_labels(k = 4) %>%
set("branches_lwd", 2) %>%
set("labels_cex", 0.8)
# Plotar o dendrograma
plot(dend, main = "Cluster Dendrogram", ylab = "Height")
# Plotar o dendrograma
plot(dend, main = "Cluster Dendrogram", xlab = "Height", horiz = TRUE)
# Vamos gerar um conjunto de dados de exemplo
set.seed(123)
data <- matrix(rnorm(100), nrow = 20)
# Calcular a matriz de dist√¢ncias
dist_matrix <- dist(data)
# Aplicar o m√©todo de liga√ß√£o m√©dia entre grupo (UPGMA)
hc <- hclust(dist_matrix, method = "average")
# Converter para um dendrograma
dend <- as.dendrogram(hc)
# Personalizar o dendrograma
dend <- dend %>%
color_branches(k = 4) %>%  # Definir o n√∫mero de clusters
color_labels(k = 4) %>%
set("branches_lwd", 2) %>%
set("labels_cex", 0.8)
# Inverter a ordem dos labels
dend <- rotate(dend, order = rev(labels(dend)))
# Plotar o dendrograma horizontalmente
plot(dend, main = "Cluster Dendrogram", xlab = "Height", horiz = TRUE)
# Inverter a ordem dos labels
dend <- rev(dend)
# Plotar o dendrograma horizontalmente
plot(dend, main = "Cluster Dendrogram", xlab = "Height", horiz = TRUE)
# Criar um conjunto de dados fict√≠cio
set.seed(123)
# Criar um conjunto de dados fict√≠cio
set.seed(123)
SampleID <- 1:20
Feature1 <- rnorm(20, mean = 50, sd = 10)
Feature2 <- rnorm(20, mean = 30, sd = 5)
Feature3 <- rnorm(20, mean = 70, sd = 15)
data <- data.frame(SampleID, Feature1, Feature2, Feature3)
View(data)
# Calcular a matriz de dist√¢ncias usando apenas as vari√°veis Feature1, Feature2, Feature3
dist_matrix <- dist(data[, -1])  # Excluir a coluna SampleID
# Aplicar o m√©todo de liga√ß√£o m√©dia entre grupo (UPGMA)
hc <- hclust(dist_matrix, method = "average")
# Converter para um dendrograma
dend <- as.dendrogram(hc)
# Personalizar o dendrograma
dend <- dend %>%
color_branches(k = 4) %>%  # Definir o n√∫mero de clusters
color_labels(k = 4) %>%
set("branches_lwd", 2) %>%
set("labels_cex", 0.8)
# Inverter a ordem dos labels
dend <- rev(dend)
# Plotar o dendrograma horizontalmente da esquerda para a direita
plot(dend, main = "Cluster Dendrogram", xlab = "Height", horiz = TRUE, axes = FALSE)
# Inverter a ordem dos labels
dend <- rotate(dend, order = rev(labels(dend)))
# Plotar o dendrograma horizontalmente
plot(dend, main = "Cluster Dendrogram", xlab = "Height", horiz = TRUE)
installed.packages("MultivariateAnalysis")
library(miRNATargets)
# Instala√ß√£o do pacote
if (!requireNamespace("miRNATargets", quietly = TRUE)) {
install.packages("miRNATargets")
}
library(miRNATargets)
if (!requireNamespace("targetscan.Hs.eg.db", quietly = TRUE)) {
BiocManager::install("targetscan.Hs.eg.db")
}
# Carregamento dos pacotes necess√°rios
library(BiocManager)
library(multiMiR)
library(rio)
library(dplyr)
setwd("F:/Higor/Metabolic_gene_analysis_05/2- Searching_for_miRNA")
# Importando conjunto de genes
data <- import("Target_genes.tsv")
# Extraindo a coluna de genes como um vetor de caracteres
genes <- as.character(data$Genes)
# Utilizando o multiMiR para prever os miRNAs alvos dos mRNAs
mirna_targets <- get_multimir(
org = 'hsa',
target = genes,
table = "validated",
summary = FALSE,
add.link = TRUE
)
View(data)
# Extraindo os dados
mirna_targets_data <- mirna_targets@data
View(mirna_targets_data)
# Importando conjunto de genes
data <- import("Target_genes.tsv")
# Extraindo a coluna de genes como um vetor de caracteres
genes <- as.character(data$Genes)
# Utilizando o multiMiR para prever os miRNAs alvos dos mRNAs
mirna_targets <- get_multimir(
org = 'hsa',
target = genes,
table = "validated",
summary = FALSE
)
# Extraindo os dados
mirna_targets_data <- mirna_targets@data
# Salvando os resultados em um arquivo tsv
export(mirna_targets_data, "mirna_targets_data.tsv")
# Filtrando as colunas relevantes para mostrar a rela√ß√£o entre miRNA e mRNA
Target_mirna <- mirna_targets_data[, c("database", "mature_mirna_id", "target_symbol", "pubmed_id")]
# Renomear as colunas
Target_mirna <- Target_mirna %>%
rename(
Database = database,
Mature_mirna_id = mature_mirna_id,
Target_genes = target_symbol,
Pubmed_id = pubmed_id,
)
# Ornanizando os Target genes em ordem alfab√©tica
All_target_mirna <- Target_mirna[order(Target_mirna$Target_genes), ]
View(All_target_mirna)
# Salvando os resultados em um arquivo tsv
export(Target_mirna, "All_target_mirna.tsv")
# Removendo linhas sem pubmed id
Target_mirna <- Target_mirna[!is.na(Target_mirna$pubmed_id)]
View(Target_mirna)
# Filtrando as colunas relevantes para mostrar a rela√ß√£o entre miRNA e mRNA
Target_mirna <- mirna_targets_data[, c("database", "mature_mirna_id", "target_symbol", "pubmed_id")]
# Renomear as colunas
Target_mirna <- Target_mirna %>%
rename(
Database = database,
Mature_mirna_id = mature_mirna_id,
Target_genes = target_symbol,
Pubmed_id = pubmed_id,
)
# Ornanizando os Target genes em ordem alfab√©tica
All_target_mirna <- Target_mirna[order(Target_mirna$Target_genes), ]
View(Target_mirna)
# Removendo linhas sem pubmed id
Target_mirna <- Target_mirna[!is.na(Target_mirna$Pubmed_id)]
# Removendo linhas sem pubmed id
Target_mirna <- Target_mirna[!is.na(Target_mirna$Pubmed_id)]
Target_mirna <- Target_mirna %>% filter(!is.na(Pubmed_id))
View(Target_mirna)
Target_mirna <- Target_mirna %>% filter(!is.na(Pubmed_id))
Target_mirna <- Target_mirna %>% filter(!is.na(Pubmed_id))
library(dplyr)
# Remove rows where Pubmed_id is NA or an empty string
Target_mirna <- Target_mirna[!(is.na(Target_mirna$Pubmed_id) | Target_mirna$Pubmed_id == ""), ]
View(Target_mirna)
View(mirna_targets_data)
# Remove rows where Pubmed_id is NA or an empty string
Target_mirna <- Target_mirna[!(is.na(Target_mirna$Pubmed_id) | Target_mirna$Pubmed_id == "0"), ]
# Salvando os resultados em um arquivo tsv
export(Target_mirna, "Target_mirna_pubmed_id.tsv")
View(Target_mirna)
View(Target_mirna)
# Removendo miRNA duplicados
Target_mirna <- Target_mirna[!duplicated(Target_mirna$Mature_mirna_id)]
# Removendo miRNA duplicados
Target_mirna <- Target_mirna[!duplicated(Target_mirna$Mature_mirna_id)]
colnames(Target_mirna)
# Removendo miRNA duplicados
Target_mirna <- Target_mirna %>% distinct(Mature_mirna_id, .keep_all = TRUE)
View(Target_mirna)
# Keep only the column named "Mature_mirna_id"
Target_mirna <- Target_mirna %>% select(Mature_mirna_id)
# Salvando os resultados em um arquivo tsv
export(Target_mirna, "Target_mirna.tsv")
# Carregamento dos pacotes necess√°rios
library(BiocManager)
library(multiMiR)
library(rio)
library(dplyr)
setwd("F:/Higor/Cancer_metabolism_analysis_06/2- Searching for target miRNA/")
setwd("D:/Cancer_metabolism_analysis_06/2- Searching_for_target_miRNA")
setwd("D:/Cancer_metabolism_analysis_06/2- Searching_for_target_miRNA")
# Importando conjunto de genes
data <- import("/Higor/Cancer_metabolism_analysis_06/1- Searching for target coding genes/Target_genes.tsv")
# Importando conjunto de genes
data <- import("/Cancer_metabolism_analysis_06/1- Searching for target coding genes/Target_genes.tsv")
# Importando conjunto de genes
data <- import("/Cancer_metabolism_analysis_06/1- Searching_for_target_coding_genes/Target_genes.tsv")
View(data)
# Importando conjunto de genes
genes <- import("/Cancer_metabolism_analysis_06/1- Searching_for_target_coding_genes/Target_genes.tsv")
# Importando conjunto de miRNAs
mirna <- import("/Cancer_metabolism_analysis_06/2- Searching_for_target_miRNA/miRTarBase_MTI.csv")
View(mirna)
mirna2 <- import("/Cancer_metabolism_analysis_06/2- Searching_for_target_miRNA/hsa_MTI.csv")
mirna3 <- import("/Cancer_metabolism_analysis_06/2- Searching_for_target_miRNA/MicroRNA_Target_Sites.csv")
View(mirna2)
View(mirna3)
View(mirna2)
View(genes)
# Identificar as linhas onde lncrna$`Interaction target` corresponde a gene$Genes
matching <- mirna[mirna$miRNA %in% genes$Genes, ]
# Identificar as linhas onde lncrna$`Interaction target` corresponde a gene$Genes
matching <- mirna[mirna$`Target Gene` %in% genes$Genes, ]
View(matching)
# Importando conjunto de genes
df001_genes <- import("/Cancer_metabolism_analysis_06/1- Searching_for_target_coding_genes/Target_genes.tsv")
# Importando conjunto de miRNAs
df002_mirna <- import("/Cancer_metabolism_analysis_06/2- Searching_for_target_miRNA/hsa_MTI.csv")
# Identificar as linhas onde miRNA corresponde a gene
df003_matching <- mirna[df002_mirna$`Target Gene` %in% df001_genes$Genes, ]
# ‚úÖ Remove rows where 'PMID' is NA
df004_clean <- df003_matching[!is.na(df003_matching$`References (PMID)`), ]
View(df004_clean)
View(mirna2)
# ‚úÖ Remove rows where 'PMID' is NA
df004_clean <- df003_matching %>%
# Remove rows with NA in the PMID column
filter(!is.na(`References (PMID)`)) %>%
# Keep only rows where specie is "hsa"
filter(`Species (miRNA)` == "hsa")
View(df004_clean)
View(data)
View(df001_genes)
View(df004_clean)
View(df004_clean)
# Importando conjunto de genes
df001_genes <- import("/Cancer_metabolism_analysis_06/1- Searching_for_target_coding_genes/Target_genes.tsv")
# Importando conjunto de miRNAs
df002_mirna <- import("/Cancer_metabolism_analysis_06/2- Searching_for_target_miRNA/hsa_MTI.csv")
# Identificar as linhas onde miRNA corresponde a gene
df003_matching <- df002_mirna[df002_mirna$`Target Gene` %in% df001_genes$Genes, ]
# ‚úÖ Remove rows where 'PMID' is NA
df004_clean <- df003_matching %>%
# Remove rows with NA in the PMID column
filter(!is.na(`References (PMID)`)) %>%
# Keep only rows where specie is "hsa"
filter(`Species (miRNA)` == "hsa")
View(df004_clean)
# Exporting results
export(df004_clean, "miRNA-related_genes.tsv")
# Removing duplicated
df005_target_lncrna <- df004_clean %>% distinct(miRNA, .keep_all = TRUE)
View(df005_target_lncrna)
data2 <- import("Target_mirna.tsv")
View(data2)
# Identify differences:
# 1. In df1 but not in df2
only_in_df1 <- anti_join(df005_target_lncrna, data2, by = c("miRNA" = "Mature_mirna_id"))
# 2. In df2 but not in df1
only_in_df2 <- anti_join(data2, df005_target_lncrna, by = c("Mature_mirna_id" = "miRNA"))
# Summary of differences
cat("üîç Unique in df1 but not in df2:", nrow(only_in_df1), "genes\n")
cat("üîç Unique in df2 but not in df1:", nrow(only_in_df2), "targets\n")
View(only_in_df2)
View(only_in_df1)
# Exporting results
export(df005_target_lncrna, "New_Target_mirna.tsv")
