library(UCSCXenaShiny)
library(UCSCXenaTools)
library(survminer)
data <- tcga_surv_get(
item = "PAX9",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample"),
opt_pancan = .opt_pancan
)
library(UCSCXenaShiny)
library(UCSCXenaTools)
library(survminer)
data <- tcga_surv_get(
item = "PAX9",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
tcga_surv_plot(
data,
time = "DSS.time",
status = "DSS",
cutoff_mode = "Custom",
cutpoint = c(50, 50),
profile = "methylation",
palette = "aaas"
data <- tcga_surv_get(
item = "PAX9",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
View(data)
data <- tcga_surv_get(
item = "PAX9",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample"),
opt_pancan = .opt_pancan
)
opt_pancan = .opt_pancan
opt_pancan = .opt_pancan
data <- tcga_surv_get(
item = "PAX9",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
data <- tcga_surv_get(
item = "(PAX9 + SEMA4A)",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
data <- tcga_surv_get(
item = "(PAX9 + SEMA4A)",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
data <- tcga_surv_get(
item = "(PAX9 + SEMA4A)",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
tcga_surv_plot(
data,
time = "DSS.time",
status = "DSS",
cutoff_mode = "Custom",
cutpoint = c(50, 50),
profile = "methylation",
palette = "aaas"
tcga_surv_plot(
data,
time = "DSS.time",
status = "DSS",
cutoff_mode = "Custom",
cutpoint = c(50, 50),
profile = "methylation",
palette = "aaas"
)
setwd("F:/Higor/Cancer_metabolism_analysis_06/15- Drug Response/DGIdb 5.0 drug-gene interaction analysis")
GDIdb <- import("interactions.tsv")
# Load all required packages
library(rio)
GDIdb <- import("interactions.tsv")
View(GDIdb)
members_results <- import("/Higor/Cancer_metabolism_analysis_06/11- Verification and annotation/Single annotation/All_results_filtered.rds")
signature_results <- import("/Higor/Cancer_metabolism_analysis_06/12- Building_Signatures/All_signature/All_signature_pathways_interactions.rds")
members_unique <- as.data.frame(unique(members_results$Target))
View(members_unique)
members_unique <- unique(members_results$Target)
members_unique <- distinct(members_results, Target)
library(dplyr)
members_unique <- distinct(members_results, Target)
View(members_unique)
# Remover o prefixo "hsa-" da coluna 'Interactions'
members_unique$Target <- sub("^hsa-", "", members_unique$Target)
# Transform Target column
members_unique$Target <- members_unique$Target %>%
sub("^hsa-", "", .) %>%       # Remove "hsa-" if present
sub("miR", "MIR", .) %>%      # Replace "miR" with "MIR"
gsub("-", "", .)              # Remove all hyphens
members_unique <- distinct(members_results, Target)
# Transform Target column
members_unique$Target <- members_unique$Target %>%
sub("^hsa-", "", .) %>%       # Remove "hsa-" if present
sub("miR", "MIR", .) %>%      # Replace "miR" with "MIR"
gsub("-", "", .) %>%          # Remove all hyphens
sub("[0-9]+[a-z]?$", "", .)   # Remove trailing numeric suffixes (e.g., "-5p", "-3p", "-2a", etc.)
members_unique <- distinct(members_results, Target)
# Transform Target column
members_unique$Target <- members_unique$Target %>%
sub("^hsa-", "", .) %>%       # Remove "hsa-" if present
sub("miR", "MIR", .) %>%      # Replace "miR" with "MIR"
gsub("-", "", .) %>%          # Remove all hyphens
sub("(-5p|-3p)$", "", .)      # Remove only "-5p" or "-3p" at the end
View(members_unique)
# Transform Target column
members_unique$Target <- members_unique$Target %>%
sub("^hsa-", "", .) %>%       # Remove "hsa-" if present
sub("miR", "MIR", .) %>%      # Replace "miR" with "MIR"
gsub("-", "", .) %>%          # Remove all hyphens
sub("(5p|3p)$", "", .)      # Remove only "-5p" or "-3p" at the end
members_unique <- distinct(members_results, Target)
# Transform Target column
members_unique$Target <- members_unique$Target %>%
sub("^hsa-", "", .) %>%       # Remove "hsa-" if present
sub("miR", "MIR", .) %>%      # Replace "miR" with "MIR"
gsub("-", "", .) %>%          # Remove all hyphens
sub("(5p|3p)$", "", .)      # Remove only "-5p" or "-3p" at the end
# Filter GDIdb for rows where "gene_name" matches "Target"
filtered_GDIdb <- GDIdb %>%
filter(gene_name %in% members_unique$Target)
View(filtered_GDIdb)
filtered_GDIdb_meaningful <- filtered_GDIdb %>%
filter(interaction_type != "NULL" & interaction_type != "other/unknown")
View(filtered_GDIdb_meaningful)
filtered_GDIdb_meaningful_drug <- filtered_GDIdb %>%
filter(drug_name != "NULL")
View(filtered_GDIdb_meaningful_drug)
View(GDIdb)
colnames(filtered_GDIdb)
filtered_GDIdb <- filtered_GDIdb %>%
select(-gene_concept_id, -interaction_source_db_version, -drug_concept_id)
filtered_GDIdb_meaningful <- filtered_GDIdb %>%
filter(interaction_type != "NULL" & interaction_type != "other/unknown")
filtered_GDIdb_meaningful_drug <- filtered_GDIdb %>%
filter(drug_name != "NULL")
View(members_results)
# Loading library
library("dplyr")
library("rio")
# Setting directory
setwd("F:/Higor/Cancer_metabolism_analysis_06/3- Searching for target lncRNA")
# Importing data
lncrna <- import("function_human.xls")
# Identificar as linhas onde lncrna$`Interaction target` corresponde a gene$Genes
matching_rows_genes <- lncrna[lncrna$`Interaction target` %in% gene$Genes, ]
gene <- import("/Higor/Cancer_metabolism_analysis_06/1- Searching for target coding genes/Target_genes.tsv")
# Identificar as linhas onde lncrna$`Interaction target` corresponde a gene$Genes
matching_rows_genes <- lncrna[lncrna$`Interaction target` %in% gene$Genes, ]
# Exporting results
export(matching_rows_genes, "lncRNA-related_genes.tsv")
# Keeping only the column named "Lncrna name"
Target_lncrna <- matching_rows_genes %>% select(`LncRNA name`)
# Renaming the column name
Target_lncrna <- Target_lncrna %>% rename(Target_lncrna = `LncRNA name`)
# Removing duplicated
Target_lncrna <- Target_lncrna %>% distinct(Target_lncrna, .keep_all = TRUE)
# Exporting results
export(Target_lncrna, "New_Target_lncrna.tsv")
