library(UCSCXenaShiny)
library(UCSCXenaTools)
library(survminer)
data <- tcga_surv_get(
item = "PAX9",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample"),
opt_pancan = .opt_pancan
)
library(UCSCXenaShiny)
library(UCSCXenaTools)
library(survminer)
data <- tcga_surv_get(
item = "PAX9",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
tcga_surv_plot(
data,
time = "DSS.time",
status = "DSS",
cutoff_mode = "Custom",
cutpoint = c(50, 50),
profile = "methylation",
palette = "aaas"
data <- tcga_surv_get(
item = "PAX9",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
View(data)
data <- tcga_surv_get(
item = "PAX9",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample"),
opt_pancan = .opt_pancan
)
opt_pancan = .opt_pancan
opt_pancan = .opt_pancan
data <- tcga_surv_get(
item = "PAX9",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
data <- tcga_surv_get(
item = "(PAX9 + SEMA4A)",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
data <- tcga_surv_get(
item = "(PAX9 + SEMA4A)",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
data <- tcga_surv_get(
item = "(PAX9 + SEMA4A)",
TCGA_cohort = "LUAD",
profile = "methylation",
TCGA_cli_data = dplyr::full_join(load_data("tcga_clinical"), load_data("tcga_surv"), by
= "sample")
)
tcga_surv_plot(
data,
time = "DSS.time",
status = "DSS",
cutoff_mode = "Custom",
cutpoint = c(50, 50),
profile = "methylation",
palette = "aaas"
tcga_surv_plot(
data,
time = "DSS.time",
status = "DSS",
cutoff_mode = "Custom",
cutpoint = c(50, 50),
profile = "methylation",
palette = "aaas"
)
Pathways <- data.frame(
Genes = c(1, 1, 2, 2, 3, 4, 4),
Metabolism = c("A", "B", "B", "C", "D", "E", "E"),
Pathways = c("AA", "BB", "BB", "CC", "DD", "EE", "EE2")
)
All_results_gene <- data.frame(
genes = c(1, 1, 1, 2, 3, 4, 4)
)
# Merge entre 'All_results_gene' e 'Pathways' com base no gene
Merged_results <- merge(
All_results_gene, Pathways,
by.x = "genes", by.y = "Genes",
all.x = TRUE, # Inclui todos os genes de 'All_results_gene'
all.y = FALSE # Exclui genes de 'Pathways' que não estão em 'All_results_gene'
)
# Resultado esperado
print(Merged_results)
library(rio)
setwd("F:/Higor/Cancer_metabolism_analysis_06/1- Searching for target coding genes")
data <- import("Selected_Metabolic_Pathways_KEGG.tsv")
# Create data frame with list of genes not found in Xena Browser
Genes_not_found <- import("Genes not found.txt")
Aliases_genes_not_found <- import("Aliases_Gene_not_found.csv")
Aliases_found <- import("Aliases_found.xlsx")
View(Aliases_found)
View(Genes_not_found)
data2 <- import("Aliases_found_genes_not_found.tsv")
View(data2)
gene_set <- import("Selected_Metabolic_Pathways_KEGG.tsv")
Aliases_genes_not_found <- import("Aliases_found_genes_not_found.tsv")
# Função para substituir genes no gene_set
replace_genes <- function(genes_column, replacements) {
sapply(genes_column, function(gene) {
replacement <- replacements$Aliases_found[replacements$Genes_not_found == gene]
if (length(replacement) > 0 && !is.na(replacement)) {
return(replacement)
} else {
return(gene)
}
})
}
# Substituir genes no gene_set
gene_set$Genes <- replace_genes(gene_set$Genes, Aliases_genes_not_found)
View(Aliases_genes_not_found)
# Read the file with the list of all metabolic pathway genes
gene_set <- import("Selected_Metabolic_Pathways_KEGG.tsv")
# Create data frame with list of genes not found in Xena Browser
Genes_not_found <- import("Genes not found.txt")
Aliases_genes_not_found <- import("Aliases_Gene_not_found.xlsx")
Aliases_found <- import("Aliases_found.xlsx")
# Função para buscar aliases em Aliases_found e relacioná-los com Genes_not_found
search_alias <- function(row, aliases_found) {
# Combinar todas as colunas da linha em um vetor
all_aliases <- unlist(row)
# Verificar quais aliases encontrados estão presentes na linha
found_aliases <- aliases_found$Aliases[aliases_found$Aliases %in% all_aliases]
# Retornar os aliases encontrados ou NA
if (length(found_aliases) > 0) {
return(paste(found_aliases, collapse = ", "))
} else {
return(NA)
}
}
# Aplicar a função search_alias e criar o data frame new_target
new_target <- Aliases_genes_not_found %>%
rowwise() %>%
mutate(
Aliases_found = search_alias(c_across(everything()), Aliases_found)
) %>%
ungroup() %>%
select(Genes_not_found, Aliases_found) %>%
distinct() %>% # Remover linhas duplicadas
mutate(
Aliases_found = sapply(strsplit(Aliases_found, ","), `[`, 1) # Manter apenas o primeiro valor antes da vírgula
)
library(readr)
library(jsonlite)
library(readr)
library(ggplot2)
# Define a function to search for KEGG gene symbols
search_kegg_symbol <- function(symbol) {
result <- keggFind(database = "genes", query = symbol)
if (length(result) > 0) {
return(result)
} else {
return(NA)
}
}
# Função para buscar aliases em Aliases_found e relacioná-los com Genes_not_found
search_alias <- function(row, aliases_found) {
# Combinar todas as colunas da linha em um vetor
all_aliases <- unlist(row)
# Verificar quais aliases encontrados estão presentes na linha
found_aliases <- aliases_found$Aliases[aliases_found$Aliases %in% all_aliases]
# Retornar os aliases encontrados ou NA
if (length(found_aliases) > 0) {
return(paste(found_aliases, collapse = ", "))
} else {
return(NA)
}
}
# Aplicar a função search_alias e criar o data frame new_target
new_target <- Aliases_genes_not_found %>%
rowwise() %>%
mutate(
Aliases_found = search_alias(c_across(everything()), Aliases_found)
) %>%
ungroup() %>%
select(Genes_not_found, Aliases_found) %>%
distinct() %>% # Remover linhas duplicadas
mutate(
Aliases_found = sapply(strsplit(Aliases_found, ","), `[`, 1) # Manter apenas o primeiro valor antes da vírgula
)
Aliases_genes_not_found <- import("Aliases_Gene_not_found.xlsx")
library(dplyr)
# Função para buscar aliases em Aliases_found e relacioná-los com Genes_not_found
search_alias <- function(row, aliases_found) {
# Combinar todas as colunas da linha em um vetor
all_aliases <- unlist(row)
# Verificar quais aliases encontrados estão presentes na linha
found_aliases <- aliases_found$Aliases[aliases_found$Aliases %in% all_aliases]
# Retornar os aliases encontrados ou NA
if (length(found_aliases) > 0) {
return(paste(found_aliases, collapse = ", "))
} else {
return(NA)
}
}
# Aplicar a função search_alias e criar o data frame new_target
new_target <- Aliases_genes_not_found %>%
rowwise() %>%
mutate(
Aliases_found = search_alias(c_across(everything()), Aliases_found)
) %>%
ungroup() %>%
select(Genes_not_found, Aliases_found) %>%
distinct() %>% # Remover linhas duplicadas
mutate(
Aliases_found = sapply(strsplit(Aliases_found, ","), `[`, 1) # Manter apenas o primeiro valor antes da vírgula
)
# Criar o data frame NCBI_ALIASES com colunas "Genes_not_found" e "Aliases_found"
NCBI_ALIASES <- data.frame(
Genes_not_found = c("ATP6", "KYAT1"),
Aliases_found = c("MT-ATP6", "CCBL1")
)
# Preencher o data frame new_target com as informações encontradas em NCBI_ALIASES
new_target <- new_target %>%
left_join(NCBI_ALIASES, by = "Genes_not_found") %>%
mutate(Aliases_found = coalesce(Aliases_found.x, Aliases_found.y)) %>%
select(Genes_not_found, Aliases_found)
# Função para substituir genes no gene_set usando correspondências de new_target
replace_genes <- function(genes_column, replacements) {
sapply(genes_column, function(gene) {
# Encontrar o alias correspondente em replacements (new_target)
replacement <- replacements$Aliases_found[replacements$Genes_not_found == gene]
# Verificar se o alias foi encontrado e não é NA
if (length(replacement) > 0 && !is.na(replacement[1])) {
return(replacement[1])  # Retornar o primeiro elemento caso existam múltiplos
} else {
return(gene)  # Caso contrário, retornar o gene original
}
})
}
# Substituir genes no gene_set usando a função replace_genes
gene_set$Genes <- replace_genes(gene_set$Genes, new_target)
export(gene_set, "Target_genes_with_duplicates.tsv")
View(new_target)
View(gene_set)
